version: 1.0.{build}
init:
  - SET PGUSER=postgres
  - SET PGPASSWORD=Password12!
  - PATH=C:\Program Files\PostgreSQL\9.6\bin\;%PATH%
install:
  - nuget restore ./csharp/Mejram.sln
before_build:
  - git submodule update --init --recursive
  - psql -c "CREATE DATABASE sakila;" -U postgres
  - psql -c "CREATE USER test WITH PASSWORD 'test';" -U postgres
  - psql -d sakila -a -f ./pagila/pagila-schema.sql  -U postgres
  - psql -d sakila -a -f ./pagila/pagila-insert-data.sql  -U postgres
build:
  project: ./csharp/Mejram.sln
  verbosity: minimal
services:
  - postgresql
branches:
  only:
    - master
